"use strict";$(function(){function imageReady(){!function(window){var page=$(".page").attr("class").replace(/page/,"");$("body").append("<div id='bloom-container'></div>");var socialMenu=new BloomingMenu({startAngle:90,endAngle:270,radius:100,itemsNum:5,itemAnimationDelay:.08,CSSClassPrefix:"social-"});socialMenu.render();var localeMenu=new BloomingMenu({startAngle:200,endAngle:160,radius:100,itemsNum:2,itemAnimationDelay:.08,CSSClassPrefix:"locale-"});localeMenu.render(),$(".locale-item, .social-item").each(function(i,d){var o=this,imgURL=$("button",o).css("background-image").replace(/url\(|\)|'|"/gi,"");$.get(imgURL,function(data){var $svg=$(data).find("svg");$svg=$svg.removeAttr("xmlns:a"),$("button",o).append($svg),$("button",o).css("background-image","url()"),$("button",o).eq(0).on("click",function(){})},"xml")}),$(".locale-item-btn:eq(0)").attr("onclick","doGTranslate('zh-TW|zh-CN')"),$(".locale-item-btn:eq(1)").attr("onclick","doGTranslate('zh-TW|zh-TW')"),$(".social-item-btn:eq(4)").on("click",function(i,d){var url=location.href,title=$("h1").text();window.open("https://www.facebook.com/sharer.php?u="+encodeURIComponent(url)+"&t="+encodeURIComponent(title))}),$(".social-item-btn:eq(3)").on("click",function(i,d){var url=location.href,title=$("h1").text();window.open("https://plus.google.com/share?url="+encodeURIComponent(url)+"&title="+encodeURIComponent(title))}),$(".social-item-btn:eq(2)").on("click",function(i,d){var url=location.href,title=$("h1").text();window.open("http://line.me/R/msg/text/?"+encodeURIComponent(url+"\r\n"+title))}),$(".social-item-btn:eq(1)").on("click",function(i,d){window.open("https://www.youtube.com/user/filexkids")}),$(".social-item-btn:eq(0)").on("click",function(i,d){var url=location.href,title=$("h1").text();window.open("http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=tsina&url="+url+"&title="+title+"&key=595885820")}),$("#bloom-container").append($(".social-container, .locale-container")),$("#bloom-container").addClass(page);var offset=$("#bloom-container").offset().top-220,butt=$(document).height()-710,offsetButt=butt-220;$("body").append("<style>#bloom-container.butt{top:"+butt+"px!important}</style>"),$(window).on("scroll resize",function(){var st=$(window).scrollTop();st>offset?$("#bloom-container").addClass("fixed"):$("#bloom-container").removeClass("fixed"),st>offsetButt?$("#bloom-container").addClass("butt"):$("#bloom-container").removeClass("butt")})}(window)}function initialize(){function drawMap(data){var rows=data.rows;for(var i in rows){var pos={lat:rows[i][2].geometry.coordinates[1],lng:rows[i][2].geometry.coordinates[0]},pin=$("<div></div").append(mapicon.clone());$("img",pin).attr("src",$("img",pin).attr("src")+rows[i][3]);var marker=new Marker({map:map,position:pos,icon:{path:""},map_icon_label:pin.html()});marker.name=rows[i][1],marker.description=rows[i][0],marker.icon=rows[i][3],marker.addListener("click",function(){var container=$("<div></div>"),aside=$("<aside class='inmap'></aside>");aside.append("<h3 class='fontsize-16 font-default'>"+this.name+"</h3>"),aside.append("<p class='fontsize-13 font-default'>"+this.description+"</p>"),container.append(aside),$(".inmap").remove();var latLng={lat:this.getPosition().lat()+9e-4,lng:this.getPosition().lng()};markerInfoWindow.setPosition(latLng),markerInfoWindow.setContent(container.html()),markerInfoWindow.open(map),$(".gm-style-iw").parent().css("margin-top","-55px")})}$("html").addClass("image-ready")}var markerInfoWindow=new google.maps.InfoWindow,map=new google.maps.Map(document.getElementById("map-canvas"),{zoom:14,scrollwheel:!1,center:new google.maps.LatLng(24.974891028984523,121.52769804000853)}),script=document.createElement("script"),url=["https://www.googleapis.com/fusiontables/v1/query?"];url.push("sql=");var query="SELECT * FROM 15FsqLyGDUOflrGelPOyEoF3D5937VLar3QHj2hoF",encodedQuery=encodeURIComponent(query);url.push(encodedQuery),url.push("&callback=drawMap"),url.push("&key=AIzaSyBf_sGPZtgUPenHRRZ-8nBUp7rZYru0bBo"),script.src=url.join("");var body=document.getElementsByTagName("body")[0];body.appendChild(script);var mapicon=$(".map-icon").clone();$(".map-icon").remove(),window.drawMap=drawMap,google.maps.event.addDomListener(map,"dragend",function(){console.log(map.getCenter())})}function calendari(widget,data){var postType=$("body").attr("data-archive-post-type"),school=/.*[?|&]school=(.*)[&|#]+.*/gi.test(location.href)?decodeURIComponent(location.href.replace(/.*[?|&]school=(.*)[&|#]+.*/gi,"$1")):"",pagename=$("body").attr("data-archive-pagename"),siteUrl=$("h1 a").attr("href");pagename||postType||(postType="post");var original=widget.getElementsByClassName("actiu")[0];"undefined"==typeof original&&(original=document.createElement("table"),original.setAttribute("data-actual",data.getFullYear()+"/"+data.getMonth().pad(2)+"/"+data.getDate().pad(2)),widget.appendChild(original));var diff=data-new Date(original.getAttribute("data-actual"));diff=new Date(diff).getMonth();var e=document.createElement("table");e.className=0===diff?"amagat-esquerra":"amagat-dreta",e.innerHTML="",widget.appendChild(e),e.setAttribute("data-actual",data.getFullYear()+"/"+data.getMonth().pad(2)+"/"+data.getDate().pad(2));var fila=document.createElement("tr"),titol=document.createElement("th");titol.setAttribute("colspan",7);var boto_prev=document.createElement("button");boto_prev.className="boto-prev",boto_prev.innerHTML="&#9666;";var boto_next=document.createElement("button");boto_next.className="boto-next",boto_next.innerHTML="&#9656;",titol.appendChild(boto_prev);var anyUrl="";anyUrl=pagename?siteUrl+"?pagename="+pagename+"&school="+school+"&filter_year="+data.getFullYear():siteUrl+"?post_type="+postType+"&filter_year="+data.getFullYear(),titol.appendChild(document.createElement("a")).innerHTML=mesos[data.getMonth()]+'<a class="any" href="'+anyUrl+'">'+data.getFullYear()+"</a>",titol.appendChild(boto_next),boto_prev.onclick=function(){data.setMonth(data.getMonth()-1),calendari(widget,data)},boto_next.onclick=function(){data.setMonth(data.getMonth()+1),calendari(widget,data)},fila.appendChild(titol),e.appendChild(fila),fila=document.createElement("tr");for(var i=1;7>i;i++)fila.innerHTML+="<th>"+dies_abr[i]+"</th>";fila.innerHTML+="<th>"+dies_abr[0]+"</th>",e.appendChild(fila);for(var inici_mes=new Date(data.getFullYear(),data.getMonth(),-1).getDay(),actual=new Date(data.getFullYear(),data.getMonth(),-inici_mes),s=0;6>s;s++){for(var fila=document.createElement("tr"),d=1;8>d;d++){var cela=document.createElement("td"),a=document.createElement("a"),celaUrl="";celaUrl=pagename?siteUrl+"?pagename="+pagename+"&school="+school+"&filter_year="+actual.getFullYear()+"&filter_month="+(actual.getMonth()+1)+"&filter_day="+actual.getDate():siteUrl+"?post_type="+postType+"&filter_year="+actual.getFullYear()+"&filter_month="+(actual.getMonth()+1)+"&filter_day="+actual.getDate();var dateStr=actual.getFullYear()+"/"+(actual.getMonth()+1).pad(2)+"/"+actual.getDate().pad(2);if(a.href=cela.appendChild(a),a.innerHTML=actual.getDate(),a.href=celaUrl,actual.getMonth()!==data.getMonth()&&(cela.className="fora"),(new Date).getDate()==actual.getDate()&&(new Date).getMonth()==actual.getMonth()&&(new Date).getFullYear()==actual.getFullYear()&&(cela.className="avui"),"undefined"!=typeof highlightDates)try{var hl=$.parseJSON(highlightDates);_.contains(hl,dateStr)&&($(a).addClass("highlight"),console.log(dateStr))}catch(e){}actual.setDate(actual.getDate()+1),fila.appendChild(cela)}e.appendChild(fila)}setTimeout(function(){e.className="actiu",original.className+=0===diff?" amagat-dreta":" amagat-esquerra"},20),original.className="inactiu",setTimeout(function(){for(var inactius=document.getElementsByClassName("inactiu"),i=0;i<inactius.length;i++)widget.removeChild(inactius[i])},1e3)}if($("#menu >ul").length){var left=document.createElement("div");$(left).addClass("left-menu").append($("#menu ul:eq(0)").clone().addClass("menu")),$(left).addClass("left-menu").append($("footer .social ul").clone().addClass("social")),$(left).appendTo($("body")),$(".left-menu").prepend($(".close-menu").removeClass("hide")),$("#menu >ul").superfish({animation:{opacity:"show",height:"show"},animationOut:{opacity:"hide",height:"hide"}});$("#slidedown-menu").on("click",function(ev){TweenMax.set("html,body",{scrollTop:0}),$("body").addClass("menuon"),$(".left-menu").css("height","auto"),$(".left-menu").fadeIn(550),$(".left-menu >ul").hide().fadeIn(550),TweenMax.set($(".left-menu >ul >li >a"),{lineHeight:"11em",opacity:.01}),TweenMax.set($(".left-menu >ul.menu"),{marginTop:"200px"}),TweenMax.to($(".left-menu >ul >li >a"),.75,{lineHeight:"3em",opacity:1,onComplete:function(){$("header, footer, .page, #kv, #kvm").css("position","fixed")}}),TweenMax.to($(".left-menu >ul.menu"),.55,{marginTop:"70px"})});$(".close-menu").on("click",function(){$(".left-menu").fadeOut(550),$(".left-menu >ul").fadeOut(550,function(){$(".left-menu").css("height","auto"),$("body").removeClass("menuon"),$("header, footer, .page, #kv, #kvm, body").removeAttr("style"),$("header .mobile-menu li").removeClass("on")})}),$(".left-menu >ul >li ul").each(function(i,d){var o=$(this).parent();o.addClass("child-closed"),$(">a",o).on("click",function(){o.hasClass("child-opened")?($("ul",o).slideUp(250),o.removeClass("child-opened")):(o.addClass("child-opened"),TweenMax.set($("li a",o),{lineHeight:"11em",opacity:.01}),TweenMax.to($("li a",o),.55,{lineHeight:"3em",opacity:1}),$("ul",o).fadeIn(550))})})}$("#kv").length&&($("#kv").clone().attr("id","kvm").removeAttr("class").insertAfter($("#kv")),$("#kv ul").slick({dots:!0,infinite:!0,slidesToShow:1,centerMode:!0,variableWidth:!0,autoplay:!0,autoplaySpeed:3e3,pauseOnHover:!0,speed:2e3,cssEase:"ease-out"}),$("#kvm ul").slick({infinite:!0,slidesToShow:1,variableWidth:!0,centerMode:!0,autoplaySpeed:3e3,pauseOnHover:!0,speed:750,cssEase:"ease-in-out"})),$(".page.home .life .slide-container")&&!function(slide){var slideM=slide.clone().addClass("slide-container-mobile").removeClass("slide-container").insertAfter(slide);$("ul",slide).slick({dots:!0,infinite:!0,slidesToShow:3,slidesToScroll:3,variableWidth:!1,autoplaySpeed:3e3,pauseOnHover:!0,speed:750}),$("ul",slideM).slick({dots:!0,infinite:!0,slidesToShow:1,slidesToScroll:1,autoplaySpeed:3e3,pauseOnHover:!0,speed:250})}($(".page.home .life .slide-container")),function(){var arr=[];$(".page.home .concept li a").length&&$(".page.home .concept li a").each(function(){arr.push(this)}),$(window).on("scroll resize",function(){if(!($(window).width()>=1170)){var scrollTop=($(".header").height(),$(window).scrollTop());$(arr).each(function(i,d){scrollTop>$(d).offset().top-$(window).height()+$(d).height()/2&&scrollTop<$(d).offset().top?$(d).addClass("on"):$(d).removeClass("on")})}})}(),$("#map-canvas").length&&google.maps.event.addDomListener(window,"load",initialize),$(".page.contact .contact-list").length&&!function(slide){slide.clone().addClass("hidden-lg").removeClass("hidden-xs").removeClass("hidden-md").removeClass("hidden-sm").insertAfter(slide);slide.slick({dots:!0,infinite:!0,slidesToShow:4,slidesToScroll:4,variableWidth:!1,autoplaySpeed:3e3,pauseOnHover:!0,speed:750})}($(".page.contact .contact-list")),$(".checkradios").checkradios(),$(".dropdown").length&&$(".dropdown-menu li a").click(function(){var container=$(this).parents(".dropdown");$(".btn:first-child",container).text($(this).text()),$(".btn:first-child",container).val($(this).text()),$(this).parents("li").addClass("selected").siblings().removeClass("selected")});var mesos=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dies_abr=["日","一","二","三","四","五","六"];Number.prototype.pad=function(num){for(var str="",i=0;i<num-this.toString().length;i++)str+="0";return str+=this.toString()},$("#calendari").length&&calendari(document.getElementById("calendari"),new Date);var count=$("img.svg").length,cursor=0;if($("img.svg").each(function(){var $img=$(this),imgID=$img.attr("id"),imgClass=$img.attr("class"),imgURL=$img.attr("src");$.get(imgURL,function(data){var $svg=$(data).find("svg");"undefined"!=typeof imgID&&($svg=$svg.attr("id",imgID)),"undefined"!=typeof imgClass&&($svg=$svg.attr("class",imgClass+" replaced-svg")),$svg=$svg.removeAttr("xmlns:a"),$img.replaceWith($svg),cursor++,cursor===count&&((!$("#map-canvas").length||$(window).width()<1170)&&$("html").addClass("image-ready"),imageReady())},"xml")}),$(".page.home").length){var slideupBnr=function(){var winHeight=$(window).height(),showupArr=[];showupArr.push($(".home .concept li").eq(0).addClass("showup delay-1")),showupArr.push($(".home .concept li").eq(1).addClass("showup delay-2")),showupArr.push($(".home .concept li").eq(2).addClass("showup delay-3")),showupArr.push($(".home .bulletin li").eq(0).addClass("showup delay-1")),showupArr.push($(".home .bulletin li").eq(1).addClass("showup delay-2")),showupArr.push($(".home .bulletin li").eq(2).addClass("showup delay-3")),showupArr.push($(".home .news li").eq(0).addClass("showup delay-1")),showupArr.push($(".home .news li").eq(1).addClass("showup delay-2")),showupArr.push($(".home .news li").eq(2).addClass("showup delay-3")),showupArr.push($(".home .news li").eq(3).addClass("showup delay-1")),showupArr.push($(".home .news li").eq(4).addClass("showup delay-2")),showupArr.push($(".home .news li").eq(5).addClass("showup delay-3")),showupArr.push($(".home .news li").eq(6).addClass("showup delay-1")),showupArr.push($(".home .news li").eq(7).addClass("showup delay-2")),showupArr.push($(".home .news li").eq(8).addClass("showup delay-3")),showupArr.push($(".home .life li").eq(0).addClass("showup delay-1")),showupArr.push($(".home .life li").eq(1).addClass("showup delay-2")),showupArr.push($(".home .life li").eq(2).addClass("showup delay-3")),showupArr.push($(".home .life li").eq(3).addClass("showup delay-1")),showupArr.push($(".home .life li").eq(4).addClass("showup delay-2")),showupArr.push($(".home .life li").eq(5).addClass("showup delay-3")),showupArr.push($(".home .life li").eq(6).addClass("showup delay-1")),showupArr.push($(".home .life li").eq(7).addClass("showup delay-2")),showupArr.push($(".home .life li").eq(8).addClass("showup delay-3")),showupArr.push($(".home .blog li").eq(0).addClass("showup delay-1")),showupArr.push($(".home .blog li").eq(1).addClass("showup delay-2")),showupArr.push($(".home .blog li").eq(2).addClass("showup delay-3")),showupArr.push($(".home .blog li").eq(3).addClass("showup delay-4")),showupArr.push($(".home .blog li").eq(4).addClass("showup delay-5")),$(window).width()>=1170&&$.each(showupArr,function(i,d){try{$(window).scrollTop()+winHeight-100>d.offset().top&&d.addClass("on")}finally{return!0}})};$(window).on({resize:function(){slideupBnr()},scroll:function(){slideupBnr()}})}if($(".gotop").length){$(".gotop").on("click",function(ev){var tl=new TimelineMax({paused:!0});tl.set(".gotop .fly",{top:ev.clientY,position:"fixed"}),tl.add([function(){$(".gotop").removeClass("showup")}]),tl.add([TweenMax.to("body",1,{scrollTop:0})]),tl.add([TweenMax.to(".gotop .fly",.25,{opacity:0})]),tl.add([function(){$(".gotop .fly").removeAttr("style"),$(".gotop").addClass("showup")}]),tl.play()}),$(".gotop").addClass("showup delay-1");var scrollGotoTop=function(){var winHeight=$(window).height();if($(window).width()>=768){var d=$(".gotop");$(window).scrollTop()+winHeight-100>d.offset().top?d.addClass("on"):d.removeClass("on")}};$(window).on({resize:function(){scrollGotoTop()},scroll:function(){scrollGotoTop()}})}if($(".form").length){var wpcf7=$("div[id^=wpcf7]"),form=$(".form form");$("button",form).unbind("click").on("click",function(e){e.preventDefault(),e.stopPropagation(),$("input",form).each(function(i,d){$("input[name="+d.name+"]",wpcf7).val(d.value)}),$(".options input").each(function(i,d){d.checked&&$("input[name="+d.name+"]").val(d.value)}),$("textarea",form).each(function(i,d){$("textarea[name="+d.name+"]",wpcf7).val($(d).val())}),$(".wpcf7-form").submit()})}if($(".filter-dropdown").length&&$(".filter-dropdown li").on("click",function(){var school=($("body").attr("data-archive-post-type"),$("body").attr("data-archive-pagename"),_.contains($("#dropdownSchool").val(),"全部")?"":$("#dropdownSchool").val()),year=_.contains($("#dropdownYear").val(),"全部")?"":$("#dropdownYear").val(),siteUrl=$("h1 a").attr("href");$("#dropdownSchool").val()&&$("#dropdownYear").val()&&(location.href=siteUrl+"?pagename="+$("body").attr("data-archive-pagename")+"&school="+school+"&filter_year="+year)}),$(".sidebar.newsgreen *.orange").removeClass("orange").addClass("newsgreen"),$(window).trigger("resize"),$("footer .link ul").length){for(var minimum=8,slides=$("footer .link ul li").length;(minimum-=slides)>0;)$("footer .link ul li").clone().appendTo($("footer .link ul"));$("footer .link ul").slick({dots:!1,arrows:!1,infinite:!0,slidesToShow:4,slidesToScroll:1,variableWidth:!0,autoplaySpeed:5e3,autoplay:!0,pauseOnHover:!0,speed:750,cssEase:"ease-in-out"})}$(".ib-crumb a[href*=category][href*=anounce]").length&&$(".ib-crumb a[href*=category][href*=anounce]").attr("href",$(".ib-crumb a[href*=category][href*=anounce]").attr("href").replace(/\/category/gi,""))});